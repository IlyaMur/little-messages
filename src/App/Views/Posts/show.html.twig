{% extends "base.html.twig" %}
{% block title %}
	Post
{% endblock %}

{% block body %}
	{% include "partials/_flash.html.twig" %}

	<a href="{{ APP_ROOT }}" class="btn btn-light">
		<i class="fa fa-backward"></i>
		Back
	</a>
	<h1 class="mt-3">{{ post.title }}</h1>

	<div class="bg-secondary text-white p-2 mb-3">
		Written by
		<strong>
			{{ post.author }}
		</strong>

		on
		{{ post.created_at|date("d/m/Y H:i") }}
	</div>

	<p>{{ post.body }}</p>

	{% if post.user_id == currentUser.id %}
		<hr>
		<a href="{{ APP_ROOT }}posts/edit/{{ post.id }}" class="btn btn-dark">Edit</a>

		<form class="pull-right" action="{{ APP_ROOT }}posts/destroy/{{ post.id }}" method="post">
			<button id="deletePost" class="btn btn-danger" type="submit">Delete</button>
		</form>
	{% endif %}
	<hr>

	<div class="row bootstrap snippets bootdeys">

		<div class="col-md-10 col-sm-12 mx-auto">

			<div class="comment-wrapper">
				{% if currentUser %}
					<div class="panel panel-info">
						<div class="panel-heading">
							Comment panel
						</div>
						<div class="panel-body mt-3">
							{% if comment.errors is not empty %}
								<p>Errors:</p>
								<ul>
									{% for error in comment.errors %}
										<li>{{ error }}</li>
									{% endfor %}
								</ul>
							{% endif %}
							<form id="formComment" method="post" action="{{ APP_ROOT }}comments/create">
								<textarea name='commentBody' class="form-control" placeholder="write a comment..." rows="3"></textarea>
								<input type="hidden" value="{{ post.id }}" name="postId">
								<br>
								<button class="btn btn-dark pull-right">Post</button>
							</form>
						{% endif %}


						<div class="clearfix"></div>
						<hr>
						{% if comments %}
							<ul class="media-list">
								{% for comment in comments %}
									<li class="media">
										<a href="#" class="pull-left">
											<img src="https://bootdey.com/img/Content/user_1.jpg" alt="" class="img-circle">
										</a>
										<div class="media-body">
											<span class="text-muted pull-right">
												<small class="text-muted">{{ comment.createdAt | date("d-m-y H:i") }}</small>
											</span>
											<strong class="text-dark">{{ comment.author  }}</strong>
											<p>
												{{ comment.body }}
											</p>
										</div>
									</li>
								{% endfor %}
							{% else %}
								No comments yet...
							</ul>
						{% endif %}
					</div>
				</div>
			</div>

		</div>
	</div>
	<script src="{{ APP_ROOT }}js/script.js"></script>
{% endblock %}
